// database
datasource db {
  provider  = "mongodb"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_DATABASE_URL")
}

generator nextjs {
  provider = "prisma-client-js"
  output   = "../app/generated/prisma"
}

model User {
  id                        String         @id @default(auto()) @map("_id") @db.ObjectId
  email                     String         @unique
  telegramId                String         @unique
  uuid                      String         @default(cuid())
  useriddb                  String
  usernamedb                String         @unique
  firstName                 String?
  lastName                  String?
  itemdiddb                 String
  requestiddb               String
  transactioniddb           String         @unique
  timestampdb               DateTime
  secretdb                  String
  telegrampaymentchargeiddb String
  balancedb                 Int            @default(0)
  statusdb                  PurchaseStatus @default(PENDING)
  amountdb                  Int
  withdrawalamountdb        Int
  currency                  String         @default("XTR")
  invoiceLink               String?
  errorMessage              String?
  createdAt                 DateTime       @default(now())
  updatedAt                 DateTime       @updatedAt
  isActive                  Boolean        @default(true)
  lastSeenAt                DateTime?

  @@map("users")
}

// Enum for purchase statuses (recommended for type safety)
enum PurchaseStatus {
  PENDING
  COMPLETED
  FAILED
  CANCELLED
  REFUNDED

  @@map("purchase_status")
}
