// Assuming this is the structure based on the error context
import React from 'react';

interface Item {
  id: string;
  name: string;
  icon?: string;
  // ... other item properties
}

interface Purchase {
  itemid: string | Item;
  timestamp: string | number | Date;
  // ... other purchase properties
}

interface PurchaseHistoryItemProps {
  purchase: Purchase;
  item?: Item;
  onViewSecret: (purchase: Purchase) => void;
  onWithdraw: (transactionId: string) => void;
}

export default function PurchaseHistoryItem({ purchase, item, onViewSecret, onWithdraw }: PurchaseHistoryItemProps) {
  // Helper function to safely get the item name
  const getItemName = () => {
    if (item?.name) {
      return item.name;
    }
    
    // If purchase.itemid is a string, return it
    if (typeof purchase.itemid === 'string') {
      return purchase.itemid;
    }
    
    // If purchase.itemid is an Item object, return its name
    if (typeof purchase.itemid === 'object' && purchase.itemid?.name) {
      return purchase.itemid.name;
    }
    
    // Fallback
    return 'Unknown Item';
  };

  return (
    <div className="flex items-center p-4 bg-white rounded-lg shadow-sm">
      <div className="text-2xl mr-3">{item?.icon || '🎁'}</div>
      <div className="flex-1">
        <h3 className="font-medium">{getItemName()}</h3>
        <p className="text-xs tg-hint">
          {new Date(purchase.timestamp).toLocaleString()}
        </p>
      </div>
      <div className="flex flex-col space-y-2">
        <button 
          onClick={() => onViewSecret(purchase)}
          className="px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600"
        >
          View Secret
        </button>
        <button 
          onClick={() => onWithdraw(purchase.transactionid || '')}
          className="px-3 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600"
        >
          Withdraw
        </button>
      </div>
    </div>
  );
}